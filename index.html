<script>
    // *** Menu Data (Full lists) ***
    const menuData = [
        { id: 1, name: '‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
        { id: 2, name: '‡πÅ‡∏Ñ‡∏ô‡∏ï‡∏≤‡∏•‡∏π‡∏õ', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
        { id: 3, name: '‡∏ô‡∏°‡∏™‡∏î', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
        { id: 4, name: '‡∏ô‡∏°‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
        { id: 5, name: '‡∏ô‡∏°‡∏ß‡∏≤‡∏ô‡∏¥‡∏•‡∏•‡∏≤', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
        { id: 6, name: '‡∏ô‡∏°‡∏Ñ‡∏≤‡∏£‡∏≤‡πÄ‡∏°‡∏•', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
        { id: 7, name: '‡∏ô‡∏°‡πÄ‡∏¢‡πá‡∏ô/‡∏ô‡∏°‡∏ä‡∏°‡∏û‡∏π', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
        { id: 8, name: '‡∏ô‡∏°‡∏ö‡∏£‡∏≤‡∏ß‡∏ô‡πå‡∏ä‡∏π‡∏Å‡∏≤‡∏£‡πå', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
        { id: 9, name: '‡∏ô‡∏°‡∏™‡∏î ‡∏á‡∏≤‡∏î‡∏≥', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
        { id: 10, name: '‡∏ô‡∏°‡∏°‡∏¥‡πâ‡∏ô‡∏ó‡πå', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
        { id: 11, name: '‡πÇ‡∏Å‡πÇ‡∏Å‡πâ', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
        { id: 12, name: '‡∏ô‡∏°‡∏°‡∏¥‡πâ‡∏ô‡∏ó‡πå‡πÇ‡∏Å‡πÇ‡∏Å‡πâ', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
        { id: 13, name: '‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï', prices: { '16 Oz.': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: 14, name: '‡∏ô‡∏°‡∏°‡∏¥‡πâ‡∏ô‡∏ó‡πå‡∏ä‡πá‡∏≠‡∏Å', prices: { '16 Oz.': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: 15, name: '‡∏ô‡∏°‡∏™‡∏î‡πÇ‡∏≠‡∏£‡∏¥‡πÇ‡∏≠‡πâ', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
        { id: 16, name: '‡∏ô‡∏°‡∏Å‡∏•‡πâ‡∏ß‡∏¢', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
        { id: 17, name: '‡∏Å‡∏•‡πâ‡∏ß‡∏¢‡∏ä‡πá‡∏≠‡∏Å', prices: { '16 Oz.': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: 18, name: '‡∏Å‡∏•‡πâ‡∏ß‡∏¢‡πÇ‡∏Å‡πÇ‡∏Å‡πâ', prices: { '16 Oz.': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: 19, name: '‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏ô‡∏°‡∏™‡∏î', prices: { '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 55 } },
        { id: 20, name: '‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢ (‡πÑ‡∏ï‡πâ‡∏´‡∏ß‡∏±‡∏ô)', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
        { id: 21, name: '‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢ (‡πÉ‡∏ö‡∏ä‡∏≤)', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
        { id: 22, name: '‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢ ‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß', prices: { '16 Oz.': 45, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
        { id: 23, name: '‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (‡πÑ‡∏°‡πà‡∏Å‡∏•‡∏¥‡πà‡∏ô‡∏°‡∏∞‡∏•‡∏¥)', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
        { id: 24, name: '‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß', prices: { '16 Oz.': 45, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
        { id: 25, name: '‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏°‡∏∞‡∏ô‡∏≤‡∏ß', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
        { id: 26, name: '‡∏ä‡∏≤‡∏°‡∏∞‡∏ô‡∏≤‡∏ß', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
        { id: 27, name: '‡∏ä‡∏≤‡∏û‡∏µ‡∏ä', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
        { id: 28, name: '‡∏ä‡∏≤‡∏°‡∏∞‡∏•‡∏¥', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
        { id: 29, name: '‡∏ä‡∏≤‡∏•‡∏¥‡πâ‡∏ô‡∏à‡∏µ‡πà', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
    ];
    
    const matchaMenuData = [
        { id: -1, name: '‡πÄ‡∏û‡∏µ‡∏¢‡∏ß‡∏°‡∏±‡∏ó‡∏â‡∏∞', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40 } },
        { id: -2, name: '‡πÄ‡∏û‡∏µ‡∏¢‡∏ß‡∏°‡∏±‡∏ó‡∏â‡∏∞ ‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40 } },
        { id: -3, name: '‡πÄ‡∏û‡∏µ‡∏¢‡∏ß‡∏°‡∏±‡∏ó‡∏â‡∏∞ ‡∏ß‡∏≤‡∏ô‡∏¥‡∏•‡∏•‡∏≤', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40 } },
        { id: -4, name: '‡πÄ‡∏û‡∏µ‡∏¢‡∏ß‡∏°‡∏±‡∏ó‡∏â‡∏∞ ‡∏Ñ‡∏≤‡∏£‡∏≤‡πÄ‡∏°‡∏•', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40 } },
        { id: -5, name: '‡πÄ‡∏û‡∏µ‡∏¢‡∏ß‡∏°‡∏±‡∏ó‡∏â‡∏∞ ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60 } },
        { id: -6, name: '‡πÄ‡∏û‡∏µ‡∏¢‡∏ß‡∏°‡∏±‡∏ó‡∏â‡∏∞ ‡∏ô‡πâ‡∏≥‡∏™‡πâ‡∏°', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60 } },
        { id: -7, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
        { id: -8, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡πÇ‡∏≠‡∏£‡∏¥‡πÇ‡∏≠‡πâ', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
        { id: -9, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏Ñ‡∏≤‡∏£‡∏≤‡πÄ‡∏°‡∏•', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -10, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏™‡∏î', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
        { id: -11, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏ß‡∏≤‡∏ô‡∏¥‡∏•‡∏•‡∏≤', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -12, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
        { id: -13, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏ö‡∏•‡∏π‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
        { id: -14, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -15, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞ ‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤‡πÇ‡∏ô‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 70 } },
        { id: -16, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏Ñ‡∏≠‡∏ü‡∏ü‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 70 } },
        { id: -17, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏ñ‡∏±‡πà‡∏ß‡πÅ‡∏î‡∏á', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
        { id: -18, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞ ‡∏ñ‡∏±‡πà‡∏ß‡πÅ‡∏î‡∏á (‡∏õ‡∏±‡πà‡∏ô)', prices: { '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
    ];
    
    const coffeeMenuData = [
        { id: -101, name: '‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤‡πÇ‡∏ô‡πà', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 45, '‡∏õ‡∏±‡πà‡∏ô': 55 } },
        { id: -102, name: '‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤‡πÇ‡∏ô‡πà ‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 50, '‡∏õ‡∏±‡πà‡∏ô': 60 } },
        { id: -103, name: '‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤‡πÇ‡∏ô‡πà ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -104, name: '‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤‡πÇ‡∏ô‡πà ‡∏ô‡πâ‡∏≥‡∏™‡πâ‡∏°', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -105, name: '‡πÄ‡∏≠‡∏™‡πÄ‡∏õ‡∏£‡∏™‡πÇ‡∏ã‡πà', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -106, name: '‡∏•‡∏≤‡πÄ‡∏ï‡πâ', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -107, name: '‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß ‡∏ô‡∏°‡∏™‡∏î', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -108, name: '‡∏ß‡∏≤‡∏ô‡∏¥‡∏•‡∏•‡∏≤ ‡∏•‡∏≤‡πÄ‡∏ï‡πâ', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -109, name: '‡∏Ñ‡∏≤‡∏õ‡∏π‡∏ä‡∏¥‡πÇ‡∏ô‡πà', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -110, name: '‡∏°‡∏≠‡∏Ñ‡∏Ñ‡πà‡∏≤', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -111, name: '‡∏Ñ‡∏≤‡∏£‡∏≤‡πÄ‡∏°‡∏• ‡∏°‡∏±‡∏Ñ‡∏Ñ‡∏¥‡∏≠‡∏≤‡πÇ‡∏ï‡πâ', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -112, name: '‡πÄ‡∏Æ‡πÄ‡∏ã‡∏•‡∏ô‡∏±‡∏ó ‡∏•‡∏≤‡πÄ‡∏ï‡πâ', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -113, name: '‡∏°‡∏≠‡∏Ñ‡∏Ñ‡πà‡∏≤ ‡∏°‡∏¥‡πâ‡∏ô‡∏ó‡πå', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -114, name: '‡πÑ‡∏ß‡∏ó‡πå‡∏ä‡πá‡∏≠‡∏Å ‡∏°‡∏≠‡∏Ñ‡∏Ñ‡πà‡∏≤', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -115, name: '‡∏Ñ‡∏≤‡∏£‡∏≤‡πÄ‡∏°‡∏• ‡πÄ‡∏Æ‡πÄ‡∏ã‡∏•‡∏ô‡∏±‡∏ó ‡∏•‡∏≤‡πÄ‡∏ï‡πâ', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
    ];
    
    const fruitSmoothieData = [
        { id: -201, name: '‡∏ô‡∏°‡∏™‡∏î ‡∏Å‡∏µ‡∏ß‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 55 } },
        { id: -202, name: '‡∏ô‡∏°‡∏™‡∏î ‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 55 } },
        { id: -203, name: '‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà ‡∏ä‡πá‡∏≠‡∏Å', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
        { id: -204, name: '‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢ ‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
        { id: -205, name: '‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
        { id: -206, name: '‡πÇ‡∏Å‡πÇ‡∏Å‡πâ ‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
        { id: -207, name: '‡∏ä‡πá‡∏≠‡∏Å ‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 55, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -208, name: '‡∏ô‡∏°‡∏™‡∏î ‡∏ö‡∏•‡∏π‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
        { id: -209, name: '‡∏ö‡∏•‡∏π‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà ‡∏ä‡πá‡∏≠‡∏Å', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
    ];

    const smoothieYogurtData = [
        { id: -301, name: '‡∏Å‡∏µ‡∏ß‡∏µ‡πà', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
        { id: -302, name: '‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
        { id: -303, name: '‡∏û‡∏µ‡∏ä', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
        { id: -304, name: '‡∏ö‡∏•‡∏π‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -305, name: '‡∏°‡∏¥‡∏Å‡∏ã‡πå‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -306, name: '‡πÇ‡∏¢‡πÄ‡∏Å‡∏¥‡∏£‡πå‡∏ï ‡∏õ‡∏µ‡πÇ‡∏õ‡πâ', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
        { id: -307, name: '‡∏•‡∏¥‡πâ‡∏ô‡∏à‡∏µ‡πà', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
        { id: -308, name: '‡∏™‡πâ‡∏°', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
    ];


    // ‡∏£‡∏ß‡∏°‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    const allMenuData = [...menuData, ...matchaMenuData, ...coffeeMenuData, ...fruitSmoothieData, ...smoothieYogurtData];

    const sweetnessOptions = ['100%', '75%', '50%', '25%'];

    let currentOrder = [];
    let orderQueue = JSON.parse(localStorage.getItem('orderQueue')) || [];
    let orderCounter = orderQueue.length > 0 ? Math.max(...orderQueue.map(o => o.id)) + 1 : 1;
    // NEW: Load Menu Sales Log
    let menuSalesLog = JSON.parse(localStorage.getItem('menuSalesLog')) || []; 

    const menuGrid = document.getElementById('menu-grid');
    const currentOrderItemsEl = document.getElementById('current-order-items');
    const totalPriceEl = document.getElementById('total-price');
    const submitOrderBtn = document.getElementById('submit-order-btn');
    const orderQueueEl = document.getElementById('order-queue');
    const deliveryAddressInput = document.getElementById('delivery-address');

    // Dashboard Elements
    const salesTodayEl = document.getElementById('sales-today');
    const salesWeekEl = document.getElementById('sales-week');
    const salesMonthEl = document.getElementById('sales-month');

    // Modal Elements
    const menuReportModal = document.getElementById('menu-report-modal');
    const menuReportContent = document.getElementById('menu-report-content');
    const matchaModal = document.getElementById('matcha-modal');
    const matchaMenuListEl = document.getElementById('matcha-menu-list');
    const coffeeModal = document.getElementById('coffee-modal');
    const coffeeMenuListEl = document.getElementById('coffee-menu-list');
    const fruitSmoothieModal = document.getElementById('fruit-smoothie-modal');
    const fruitSmoothieListEl = document.getElementById('fruit-smoothie-list');
    const smoothieYogurtListEl = document.getElementById('smoothie-yogurt-list');
    
    // QR Code Elements
    const qrPaymentModal = document.getElementById('qr-payment-modal');
    const qrTotalAmountEl = document.getElementById('qr-total-amount');

    // NEW: Global variable to hold the last committed order for sharing
    let lastCommittedOrder = null;


    // Helper function to find item data from all menus
    function getItemDataById(itemId) {
        return allMenuData.find(i => i.id === itemId);
    }
    
    function showPaymentQRModal(orderTotal) {
        qrTotalAmountEl.textContent = `‡∏ø${orderTotal.toLocaleString('th-TH')}`;
        qrPaymentModal.classList.remove('hidden');
    }

    // --- All Modal render functions (retained) ---
    
    function showFruitSmoothieModal() {
        renderFruitSmoothieMenu();
        fruitSmoothieModal.classList.remove('hidden');
    }

    function renderFruitSmoothieMenu() {
        fruitSmoothieListEl.innerHTML = '';
        smoothieYogurtListEl.innerHTML = '';

        // --- 1. Fruit Smoothie Section ---
        const fruitSmoothieHeader = document.createElement('div');
        fruitSmoothieHeader.className = 'flex justify-between text-center font-bold text-gray-600 mb-2 border-b pb-1 text-sm';
        fruitSmoothieHeader.innerHTML = `
            <span class="w-1/2 text-left">‡πÄ‡∏°‡∏ô‡∏π</span>
            <span class="w-1/4">16 Oz.</span>
            <span class="w-1/4">22 Oz.</span>
        `;
        fruitSmoothieListEl.appendChild(fruitSmoothieHeader);


        fruitSmoothieData.forEach(item => {
            const p16 = `${item.prices['16 Oz. ‡πÄ‡∏¢‡πá‡∏ô'] || 'X'} / ${item.prices['16 Oz. ‡∏õ‡∏±‡πà‡∏ô'] || 'X'}`;
            const p22 = `${item.prices['22 Oz. ‡πÄ‡∏¢‡πá‡∏ô'] || 'X'} / ${item.prices['22 Oz. ‡∏õ‡∏±‡πà‡∏ô'] || 'X'}`;
            
            const menuCard = document.createElement('div');
            menuCard.className = 'smoothie-menu-card';
            menuCard.setAttribute('onclick', `addToOrder(${item.id})`);
            menuCard.innerHTML = `
                <span class="w-1/2 text-sm font-medium text-gray-800">${item.name}</span>
                <span class="w-1/4 text-center text-xs price-smoothie">${p16}</span>
                <span class="w-1/4 text-center text-xs price-smoothie">${p22}</span>
            `;
            fruitSmoothieListEl.appendChild(menuCard);
        });
        
        // --- 2. Smoothie Yogurt Section ---
        const yogurtHeader = document.createElement('div');
        yogurtHeader.className = 'flex justify-between text-center font-bold text-gray-600 mb-2 border-b pb-1 text-sm';
        yogurtHeader.innerHTML = `
            <span class="w-2/3 text-left">‡πÄ‡∏°‡∏ô‡∏π (‡∏õ‡∏±‡πà‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)</span>
            <span class="w-1/6">16 Oz.</span>
            <span class="w-1/6">22 Oz.</span>
        `;
        smoothieYogurtListEl.appendChild(yogurtHeader);

        smoothieYogurtData.forEach(item => {
            const p16 = item.prices['16 Oz. ‡∏õ‡∏±‡πà‡∏ô'];
            const p22 = item.prices['22 Oz. ‡∏õ‡∏±‡πà‡∏ô'];

            const menuCard = document.createElement('div');
            menuCard.className = 'smoothie-menu-card';
            menuCard.setAttribute('onclick', `addToOrder(${item.id})`);
            menuCard.innerHTML = `
                <span class="w-2/3 text-sm font-medium text-gray-800">${item.name}</span>
                <span class="w-1/6 text-center text-xs price-smoothie">‡∏ø${p16}</span>
                <span class="w-1/6 text-center text-xs price-smoothie">‡∏ø${p22}</span>
            `;
            smoothieYogurtListEl.appendChild(menuCard);
        });
    }
    
    function showCoffeeMenuModal() {
        renderCoffeeMenu();
        coffeeModal.classList.remove('hidden');
    }

    function renderCoffeeMenu() {
        coffeeMenuListEl.innerHTML = '';
        coffeeMenuData.forEach(item => {
            let priceDisplay = '';
            const sizes = Object.keys(item.prices);
            
            if (sizes.length === 1) {
                priceDisplay = `‡∏ø${item.prices[sizes[0]]} (${sizes[0]})`;
            } else if (sizes.length === 2 && item.prices['‡πÄ‡∏¢‡πá‡∏ô'] && item.prices['‡∏õ‡∏±‡πà‡∏ô']) {
                if (item.prices['‡πÄ‡∏¢‡πá‡∏ô'] === item.prices['‡∏õ‡∏±‡πà‡∏ô']) {
                     priceDisplay = `‡∏ø${item.prices['‡πÄ‡∏¢‡πá‡∏ô']}`;
                } else {
                     priceDisplay = `‡∏ø${item.prices['‡πÄ‡∏¢‡πá‡∏ô']} / ‡∏ø${item.prices['‡∏õ‡∏±‡πà‡∏ô']} (‡∏õ‡∏±‡πà‡∏ô)`;
                }
            } else if (sizes.length > 0) {
                priceDisplay = sizes.map(size => `‡∏ø${item.prices[size]} (${size})`).join(', ');
            } else {
                priceDisplay = '---';
            }

            const menuCard = document.createElement('div');
            menuCard.className = 'coffee-menu-card';
            menuCard.setAttribute('onclick', `addToOrder(${item.id})`);
            menuCard.innerHTML = `
                <span class="w-2/3 text-sm font-medium text-gray-800">${item.name}</span>
                <span class="w-1/3 text-right text-sm price-coffee">${priceDisplay}</span>
            `;
            coffeeMenuListEl.appendChild(menuCard);
        });
    }
    
    function showMatchaMenuModal() {
        renderMatchaMenu();
        matchaModal.classList.remove('hidden');
    }

    function renderMatchaMenu() {
        matchaMenuListEl.innerHTML = '';
        matchaMenuData.forEach(item => {
            const p16 = item.prices['16 Oz. ‡πÄ‡∏¢‡πá‡∏ô'] ? `‡∏ø${item.prices['16 Oz. ‡πÄ‡∏¢‡πá‡∏ô']}` : 'X';
            const p22 = item.prices['22 Oz. ‡πÄ‡∏¢‡πá‡∏ô'] || item.prices['22 Oz. ‡∏õ‡∏±‡πà‡∏ô'];
            const p22Display = p22 ? `‡∏ø${p22}` : 'X';

            const menuCard = document.createElement('div');
            menuCard.className = 'matcha-menu-card';
            menuCard.setAttribute('onclick', `addToOrder(${item.id})`);
            menuCard.innerHTML = `
                <span class="w-1/2 text-sm font-medium text-gray-800">${item.name}</span>
                <span class="w-1/4 text-center text-sm ${p16 === 'X' ? 'text-red-500' : 'price-small'}">${p16}</span>
                <span class="w-1/4 text-center text-sm ${p22Display === 'X' ? 'text-red-500' : 'price-large'}">${p22Display}</span>
            `;
            matchaMenuListEl.appendChild(menuCard);
        });
    }
    
    // --- Core Application Logic (retained) ---

    function renderMenu() {
        const specialMenuIds = [
            ...matchaMenuData,
            ...coffeeMenuData,
            ...fruitSmoothieData,
            ...smoothieYogurtData
        ].map(item => item.id);
        
        const otherMenuData = menuData.filter(item => !specialMenuIds.includes(item.id));
        
        const existingSpecialButtons = menuGrid.querySelectorAll('.p-3.bg-amber-700, .p-3.bg-emerald-500, .p-3.bg-sky-500');
        const newGridContent = Array.from(existingSpecialButtons).map(btn => btn.outerHTML).join('');
        menuGrid.innerHTML = newGridContent;

        otherMenuData.forEach(item => {
            const menuItem = document.createElement('div');
            menuItem.className = 'p-3 bg-teal-50 hover:bg-teal-100 rounded-lg text-center cursor-pointer transition duration-300 shadow-sm';
            menuItem.innerHTML = `<span class="font-semibold">${item.name}</span>`;
            menuItem.onclick = () => addToOrder(item.id);
            menuGrid.appendChild(menuItem);
        });
    }

    function addToOrder(itemId) {
        const item = getItemDataById(itemId);
        if (!item) return;

        const defaultSize = Object.keys(item.prices)[0];
        const defaultSweetness = sweetnessOptions[0];

        const orderItem = {
            id: Date.now(),
            itemId: item.id,
            name: item.name,
            size: defaultSize,
            price: item.prices[defaultSize],
            quantity: 1,
            sweetness: defaultSweetness,
        };
        currentOrder.push(orderItem);
        renderCurrentOrder();
        // Close modal if open
        matchaModal.classList.add('hidden');
        coffeeModal.classList.add('hidden');
        fruitSmoothieModal.classList.add('hidden');
    }
    
    function renderCurrentOrder() {
        if (currentOrder.length === 0) {
            currentOrderItemsEl.innerHTML = '<p class="text-gray-400 text-center mt-4">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°...</p>';
            submitOrderBtn.disabled = true;
        } else {
            currentOrderItemsEl.innerHTML = '';
            currentOrder.forEach(item => {
                const menuItem = getItemDataById(item.itemId);
                const availableSizes = Object.keys(menuItem.prices);

                const sizeOptions = availableSizes.map(size =>
                    `<option value="${size}" ${item.size === size ? 'selected' : ''}>${size}</option>`
                ).join('');

                const sweetnessDropdown = sweetnessOptions.map(level =>
                    `<option value="${level}" ${item.sweetness === level ? 'selected' : ''}>${level}</option>`
                ).join('');

                const itemEl = document.createElement('div');
                itemEl.className = 'flex items-center justify-between bg-gray-50 p-2 rounded-lg';
                itemEl.innerHTML = `
                    <div class="flex-grow grid grid-cols-2 gap-2">
                        <p class="font-semibold col-span-2">${item.name}</p>
                        
                        <div class="flex flex-col">
                            <span class="text-xs font-medium text-gray-500 mb-1">‡∏Ç‡∏ô‡∏≤‡∏î</span>
                            <select class="text-sm p-1 border rounded" onchange="updateOrderItemSize(${item.id}, this.value)">
                                ${sizeOptions}
                            </select>
                        </div>
                        
                        <div class="flex flex-col">
                            <span class="text-xs font-medium text-gray-500 mb-1">‡∏´‡∏ß‡∏≤‡∏ô</span>
                            <select class="text-sm p-1 border rounded" onchange="updateOrderItemSweetness(${item.id}, this.value)">
                                ${sweetnessDropdown}
                            </select>
                        </div>
                        
                    </div>
                    <div class="flex items-center gap-2 ml-4">
                        <button class="w-6 h-6 bg-gray-200 rounded-full" onclick="updateOrderItemQuantity(${item.id}, -1)">-</button>
                        <span>${item.quantity}</span>
                        <button class="w-6 h-6 bg-gray-200 rounded-full" onclick="updateOrderItemQuantity(${item.id}, 1)">+</button>
                    </div>
                    <span class="w-20 text-right font-semibold">‡∏ø${(item.price * item.quantity).toLocaleString('th-TH')}</span>
                    <button class="ml-2 text-red-500 hover:text-red-700" onclick="removeOrderItem(${item.id})">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                    </button>
                `;
                currentOrderItemsEl.appendChild(itemEl);
            });
            submitOrderBtn.disabled = false;
        }
        updateTotalPrice();
    }

    function updateOrderItemSweetness(orderItemId, newSweetness) {
        const orderItem = currentOrder.find(item => item.id === orderItemId);
        orderItem.sweetness = newSweetness;
        renderCurrentOrder();
    }
    
    function updateOrderItemSize(orderItemId, newSize) {
        const orderItem = currentOrder.find(item => item.id === orderItemId);
        const menuItem = getItemDataById(orderItem.itemId);
        if (menuItem.prices[newSize] !== undefined) {
            orderItem.size = newSize;
            orderItem.price = menuItem.prices[newSize];
        }
        renderCurrentOrder();
    }

    function updateOrderItemQuantity(orderItemId, change) {
        const orderItem = currentOrder.find(item => item.id === orderItemId);
        if (orderItem.quantity + change > 0) {
            orderItem.quantity += change;
        }
        renderCurrentOrder();
    }

    function removeOrderItem(orderItemId) {
        currentOrder = currentOrder.filter(item => item.id !== orderItemId);
        renderCurrentOrder();
    }

    function updateTotalPrice() {
        const total = currentOrder.reduce((sum, item) => sum + item.price * item.quantity, 0);
        totalPriceEl.textContent = `‡∏ø${total.toLocaleString('th-TH')}`;
    }


    function isToday(date) {
        const today = new Date();
        return date.getDate() === today.getDate() && date.getMonth() === today.getMonth() && date.getFullYear() === today.getFullYear();
    }

    function isThisWeek(date) {
        const now = new Date();
        const startOfWeek = new Date(now.setDate(now.getDate() - now.getDay()));
        const endOfWeek = new Date(now.setDate(now.getDate() - now.getDay() + 6));
        return date >= startOfWeek && date <= endOfWeek;
    }

    function isThisMonth(date) {
        const now = new Date();
        return date.getMonth() === now.getMonth() && date.getFullYear() === now.getFullYear();
    }
    
    function saveOrderQueue() {
        localStorage.setItem('orderQueue', JSON.stringify(orderQueue));
    }
    
    // NEW FUNCTION: Save individual menu item sales to log
    function saveMenuSaleLog() {
        localStorage.setItem('menuSalesLog', JSON.stringify(menuSalesLog));
    }

    function updateSalesDashboard() {
        let salesToday = 0;
        let salesWeek = 0;
        let salesMonth = 0;
        
        // Use menuSalesLog for calculating dashboard figures
        menuSalesLog.forEach(log => {
            const saleDate = new Date(log.soldAt);
            if (isToday(saleDate)) { salesToday += log.price * log.quantity; }
            if (isThisWeek(saleDate)) { salesWeek += log.price * log.quantity; }
            if (isThisMonth(saleDate)) { salesMonth += log.price * log.quantity; }
        });
        
        salesTodayEl.textContent = `‡∏ø${salesToday.toLocaleString('th-TH')}`;
        salesWeekEl.textContent = `‡∏ø${salesWeek.toLocaleString('th-TH')}`;
        salesMonthEl.textContent = `‡∏ø${salesMonth.toLocaleString('th-TH')}`;
    }

    // ===========================================
    // NEW: Share Functionality (retained)
    // ===========================================

    function shareOrderSummary() {
        if (!lastCommittedOrder) {
            alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ä‡∏£‡πå');
            return;
        }

        const itemsText = lastCommittedOrder.items.map(item =>
            `* ${item.name} (${item.size}, ‡∏´‡∏ß‡∏≤‡∏ô ${item.sweetness}) x${item.quantity} = ‡∏ø${(item.price * item.quantity).toLocaleString('th-TH')}`
        ).join('\n');

        const shareText =
            `‚úÖ *‡∏™‡∏£‡∏∏‡∏õ‡∏ö‡∏¥‡∏• #${lastCommittedOrder.id} - ${new Date().toLocaleDateString('th-TH')}*\n` +
            `----------------------------------------\n` +
            `${itemsText}\n` +
            `----------------------------------------\n` +
            `üìç ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ${lastCommittedOrder.address}\n` +
            `üí∞ *‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô: ‡∏ø${lastCommittedOrder.total.toLocaleString('th-TH')}*\n\n` +
            `üí¨ *[‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô] ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏ä‡πâ QR Code ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏ö‡∏°‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πÅ‡∏Å‡∏ô‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô*\n` +
            `‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ: ‡∏ô.‡∏™.‡∏ô‡∏§‡∏ï‡∏ç‡∏≤ ‡∏ô‡∏≤‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏£‡∏±‡∏Å‡∏©‡πå`;

        if (navigator.share) {
            // ‡πÉ‡∏ä‡πâ Web Share API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ (‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏ä‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö)
            navigator.share({
                title: `‡∏ö‡∏¥‡∏•‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #${lastCommittedOrder.id}`,
                text: shareText
            }).catch((error) => {
                // Fallback to copy if share fails or cancelled
                navigator.clipboard.writeText(shareText)
                    .then(() => alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏ö‡∏¥‡∏• (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°) ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏•‡πâ‡∏ß! ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô LINE ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ (‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û QR Code ‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á)'))
                    .catch(err => console.error('Could not copy text: ', err));
            });
        } else {
            // Fallback: ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏õ‡∏ó‡∏µ‡πà Clipboard
            navigator.clipboard.writeText(shareText)
                .then(() => alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏ö‡∏¥‡∏• (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°) ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏•‡πâ‡∏ß! ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô LINE ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ (‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û QR Code ‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á)'))
                .catch(err => console.error('Could not copy text: ', err));
        }
    }
    
    // ===========================================
    // UPDATED: Submit Order (retained)
    // ===========================================

    submitOrderBtn.addEventListener('click', () => {
        const orderTotal = currentOrder.reduce((sum, item) => sum + item.price * item.quantity, 0);

        if (currentOrder.length > 0) {
            const address = deliveryAddressInput.value.trim();
            const newOrder = {
                id: orderCounter++,
                items: [...currentOrder],
                total: orderTotal,
                address: address || '‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≤‡∏ô',
                status: '‡∏Ñ‡∏¥‡∏ß',
                placedAt: Date.now(),
            };
            if (newOrder.address === '‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≤‡∏ô') {
                if (!confirm("‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà ‡∏à‡∏∞‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô '‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≤‡∏ô' ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) { return; }
            }
            
            // Set the last committed order for sharing
            lastCommittedOrder = newOrder;

            orderQueue.push(newOrder);
            currentOrder = [];
            deliveryAddressInput.value = '';
            renderCurrentOrder();
            renderOrderQueue();
            saveOrderQueue();
            
            // Show QR Code Modal
            showPaymentQRModal(orderTotal);
        }
    });
    
    function renderOrderQueue() {
        if (orderQueue.length === 0) {
            orderQueueEl.innerHTML = '<p class="text-gray-400 text-center mt-4">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏ô‡∏Ñ‡∏¥‡∏ß</p>';
            return;
        }
        const sortedQueue = [...orderQueue].sort((a, b) => {
            const statusOrder = { '‡∏Ñ‡∏¥‡∏ß': 1, '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥': 2, '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß': 3, '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å': 4 };
            return statusOrder[a.status] - statusOrder[b.status];
        });
        orderQueueEl.innerHTML = '';
        sortedQueue.forEach(order => {
            const itemsSummary = order.items.map(item => `${item.name} (${item.size}, ‡∏´‡∏ß‡∏≤‡∏ô ${item.sweetness}) x${item.quantity}`).join(', ');
            const statusColor = {
                '‡∏Ñ‡∏¥‡∏ß': 'bg-blue-100 text-blue-800',
                '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥': 'bg-yellow-100 text-yellow-800',
                '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß': 'bg-green-100 text-green-800',
                '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å': 'bg-red-100 text-red-800'
            }[order.status];
            const orderCard = document.createElement('div');
            orderCard.className = `p-4 rounded-lg shadow-sm ${order.status === '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß' || order.status === '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å' ? 'bg-gray-200 opacity-75' : 'bg-gray-50 hover:bg-white'}`;
            orderCard.innerHTML = `
                <div class="flex justify-between items-start mb-2">
                    <div>
                        <h4 class="font-bold text-lg">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #${order.id}</h4>
                        <p class="text-sm text-gray-600">${itemsSummary}</p>
                        <p class="text-xs text-gray-500 mt-1">
                            <span class="font-semibold">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</span> ${order.address}
                        </p>
                    </div>
                    <span class="text-lg font-bold text-teal-600">‡∏ø${order.total.toLocaleString('th-TH')}</span>
                </div>
                <div class="flex items-center justify-between">
                    <span class="text-sm font-semibold px-2.5 py-0.5 rounded-full ${statusColor}">${order.status}</span>
                    <div class="flex gap-2">
                        ${order.status === '‡∏Ñ‡∏¥‡∏ß' ? `<button class="text-xs bg-yellow-400 hover:bg-yellow-500 text-white font-bold py-1 px-3 rounded-lg" onclick="updateOrderStatus(${order.id}, '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥')">‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</button>` : ''}
                        ${order.status === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥' ? `<button class="text-xs bg-green-500 hover:bg-green-600 text-white font-bold py-1 px-3 rounded-lg" onclick="updateOrderStatus(${order.id}, '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß')">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</button>` : ''}
                        ${order.status !== '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß' && order.status !== '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å' ? `<button class="text-xs bg-red-500 hover:bg-red-600 text-white font-bold py-1 px-3 rounded-lg" onclick="updateOrderStatus(${order.id}, '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>` : ''}
                    </div>
                </div>
            `;
            orderQueueEl.appendChild(orderCard);
        });
    }
    
    // UPDATED FUNCTION: Update Status and log sales
    function updateOrderStatus(orderId, newStatus) {
        const order = orderQueue.find(o => o.id === orderId);
        if(order) {
            order.status = newStatus;
            
            if (newStatus === '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß') { 
                order.completedAt = Date.now();
                // ** LOGGING SALES DATA **
                order.items.forEach(item => {
                    menuSalesLog.push({
                        name: item.name,
                        size: item.size,
                        sweetness: item.sweetness,
                        quantity: item.quantity,
                        price: item.price,
                        soldAt: order.completedAt, // Use the completion time
                        orderId: order.id
                    });
                });
                saveMenuSaleLog(); // Save the updated sales log
            } else if (newStatus === '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å') {
                 // Option to remove the order from the queue if cancelled (not implemented here, but good practice)
            }

            renderOrderQueue();
            updateSalesDashboard();
            saveOrderQueue();
        }
    }
    
    // UPDATED FUNCTION: Show Menu Report (uses menuSalesLog)
    function showMenuReport() {
        const menuSales = {};
        
        // Use the dedicated log for report
        menuSalesLog.forEach(log => {
            const key = `${log.name} (${log.size}, ‡∏´‡∏ß‡∏≤‡∏ô ${log.sweetness})`;
            if (!menuSales[key]) {
                menuSales[key] = { name: log.name, size: log.size, sweetness: log.sweetness, totalQuantity: 0, totalRevenue: 0, };
            }
            menuSales[key].totalQuantity += log.quantity;
            menuSales[key].totalRevenue += log.price * log.quantity;
        });
        
        const sortedMenuReport = Object.values(menuSales).sort((a, b) => b.totalQuantity - a.totalQuantity);
        let tableHTML = '<p class="text-gray-500 mb-4">‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏Å‡πâ‡∏ß‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</p>';
        if (sortedMenuReport.length === 0) {
            tableHTML += '<p class="text-center text-gray-400 mt-10">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</p>';
        } else {
            tableHTML += `<table class="min-w-full divide-y divide-gray-200"><thead class="bg-teal-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡πÄ‡∏°‡∏ô‡∏π / ‡∏Ç‡∏ô‡∏≤‡∏î / ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏≤‡∏ô</th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡πÅ‡∏Å‡πâ‡∏ß)</th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏° (‡∏ø)</th></tr></thead><tbody class="bg-white divide-y divide-gray-200">`;
            sortedMenuReport.forEach( (report, index) => {
                tableHTML += `<tr class="${index < 3 ? 'bg-yellow-50 font-semibold' : ''}"><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${report.name} (${report.size}, ‡∏´‡∏ß‡∏≤‡∏ô ${report.sweetness})</td><td class="px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900">${report.totalQuantity.toLocaleString('th-TH')}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-right text-teal-600">${report.totalRevenue.toLocaleString('th-TH')}</td></tr>`;
            });
            tableHTML += '</tbody></table>';
        }
        menuReportContent.innerHTML = tableHTML;
        menuReportModal.classList.remove('hidden');
    }


    // Initial setup
    renderMenu();
    renderCurrentOrder();
    updateSalesDashboard();
    renderOrderQueue();
</script>
