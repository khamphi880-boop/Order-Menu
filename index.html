<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (Firebase)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Kanit:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Kanit', sans-serif;
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        /* NEW Style for menu buttons on the main grid */
        .main-menu-card {
            padding: 0.5rem;
            border-radius: 0.5rem;
            text-align: center;
            cursor: pointer;
            transition: transform 0.1s;
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            position: relative; /* For image upload button positioning */
        }
        .main-menu-card:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .menu-name {
            font-weight: 600;
            font-size: 0.9rem;
            line-height: 1.1;
            margin-bottom: 0.25rem;
        }
        .menu-price-tag {
            font-weight: 700;
            font-size: 0.8rem;
        }

        /* Style for Category Toggle Buttons */
        .category-toggle-btn {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1rem;
            font-weight: bold;
            color: white;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: opacity 0.3s;
            margin-bottom: 0.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        }
        
        /* Style for container that holds menu items */
        .menu-container-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr)); /* Use grid for sub-menus */
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        /* QR Image Container Style */
        .qr-image-container {
            width: 256px;
            height: 256px;
            margin: 0 auto;
        }
        
        /* Image Placeholder Style */
        .menu-image {
            width: 100%;
            height: 80px;
            object-fit: cover;
            border-radius: 0.25rem;
            margin-bottom: 0.5rem;
            border: 1px solid #e5e7eb;
        }

        /* Image Upload Button Style (Overlay) */
        .upload-img-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0, 0, 0, 0.6);
            color: white;
            padding: 4px 8px;
            border-radius: 50%;
            font-size: 0.75rem;
            z-index: 10;
            cursor: pointer;
            display: none; /* Hidden by default, shown by JS */
        }
        .main-menu-card:hover .upload-img-btn {
            display: block;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 max-w-7xl">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-teal-600">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h1>
            <p class="text-gray-500">‡πÉ‡∏ä‡πâ Firebase Firestore ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏¥‡∏ß‡πÅ‡∏ö‡∏ö Realtime</p>
        </header>
        
        <div class="flex justify-end mb-4">
            <button id="owner-login-btn" onclick="showOwnerLogin()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition duration-300">
                üë§ Login (Owner)
            </button>
            <button id="owner-logout-btn" onclick="firebase.auth().signOut()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition duration-300 hidden">
                üö™ Logout
            </button>
        </div>
        <div class="bg-white p-6 rounded-2xl shadow-lg mb-8">
            <h2 class="text-2xl font-semibold mb-4 border-b pb-2">üìä ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center mb-4">
                <div class="bg-blue-50 p-4 rounded-xl">
                    <p class="text-sm text-blue-600 font-medium">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p>
                    <p id="sales-today" class="text-3xl font-bold text-blue-800">‡∏ø0</p>
                </div>
                <div class="bg-green-50 p-4 rounded-xl">
                    <p class="text-sm text-green-600 font-medium">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</p>
                    <p id="sales-week" class="text-3xl font-bold text-green-800">‡∏ø0</p>
                </div>
                <div class="bg-purple-50 p-4 rounded-xl">
                    <p class="text-sm text-purple-600 font-medium">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</p>
                    <p id="sales-month" class="text-3xl font-bold text-purple-800">‡∏ø0</p>
                </div>
            </div>
            
            <button onclick="showMenuReport()" class="w-full bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                ‚≠ê ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ
            </button>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div class="bg-white p-6 rounded-2xl shadow-lg">
                <h2 class="text-2xl font-semibold mb-4 border-b pb-2">‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</h2>
                
                <div id="menu-grid" class="h-[60vh] overflow-y-auto no-scrollbar pr-2 space-y-3">
                    </div>
            </div>

            <div class="flex flex-col gap-8">
                <div class="bg-white p-6 rounded-2xl shadow-lg flex-grow flex flex-col">
                    <h2 class="text-2xl font-semibold mb-4 border-b pb-2">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</h2>
                    <div id="current-order-items" class="flex-grow space-y-2 overflow-y-auto no-scrollbar pr-2 mb-4 min-h-[150px]">
                        <p class="text-gray-400 text-center mt-4">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°...</p>
                    </div>
                    
                    <div class="mb-4">
                        <label for="delivery-address" class="block text-sm font-medium text-gray-700 mb-1">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á (Delivery Address)</label>
                        <textarea id="delivery-address" rows="3" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-teal-500 focus:border-teal-500" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà"></textarea>
                    </div>
                    
                    <div class="border-t pt-4">
                        <div class="flex justify-between items-center text-xl font-bold mb-4">
                            <span>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                            <span id="total-price" class="text-teal-600">‡∏ø0</span>
                        </div>
                        <button id="submit-order-btn" class="w-full bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-4 rounded-lg transition duration-300 disabled:bg-gray-300">
                            ‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
                        </button>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-2xl shadow-lg">
                    <h2 class="text-2xl font-semibold mb-4 border-b pb-2">‡∏Ñ‡∏¥‡∏ß‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h2>
                    <div id="order-queue" class="space-y-4 h-[25vh] overflow-y-auto no-scrollbar pr-2">
                            <p class="text-gray-400 text-center mt-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏¥‡∏ß‡∏à‡∏≤‡∏Å Firebase...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="success-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg p-8 shadow-xl text-center">
            <svg class="w-16 h-16 text-green-500 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            <h3 class="text-2xl font-semibold mb-2">‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
            <p class="text-gray-600" id="modal-message"></p>
        </div>
    </div>

    <div id="menu-report-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg p-6 shadow-xl w-11/12 max-w-2xl">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h3 class="text-2xl font-semibold text-teal-600">‚≠ê ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ</h3>
                <button onclick="document.getElementById('menu-report-modal').classList.add('hidden')" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <div id="menu-report-content" class="h-96 overflow-y-auto">
                </div>
        </div>
    </div>
    
    <div id="qr-payment-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg p-8 shadow-xl text-center w-11/12 max-w-sm">
            <h3 class="text-2xl font-bold text-teal-600 mb-2">Krungthai THAI QR PAYMENT</h3>
            <p class="text-xl font-medium text-gray-800 mb-3">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: <span id="qr-total-amount" class="text-red-600 font-extrabold">‡∏ø0</span></p>
            
            <div class="flex justify-center flex-col items-center p-2 bg-white border border-gray-100 rounded-xl shadow-lg mb-4">
                
                <div class="qr-image-container my-4">
                    <img src="https://raw.githubusercontent.com/khamphi880-boop/Order-Menu/c9af72f12e59972d1bed7b54fc7ab6831bd56952/176464.jpg" 
                            alt="Krungthai PromptPay QR Code" 
                            class="w-full h-full object-contain mx-auto">
                </div>
                
                <div class="w-full p-2 border-t pt-2">
                    <p class="text-base text-gray-700 font-semibold">
                        ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ: <span class="font-bold text-gray-900">‡∏ô.‡∏™.‡∏ô‡∏§‡∏ï‡∏ç‡∏≤ ‡∏ô‡∏≤‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏£‡∏±‡∏Å‡∏©‡πå</span>
                    </p>
                </div>
            </div>

            <p class="text-sm text-red-500 mt-2">
                *‡∏¢‡∏≠‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏±‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô)
            </p>

            <button onclick="shareOrderSummary()" class="mt-4 w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 rounded-lg flex items-center justify-center space-x-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.882 13.791 9 14.271 9 14.75c0 1.282-.622 2.45-1.608 3.018l-3.376 1.948A2.5 2.5 0 011 19.5V4.5a2.5 2.5 0 014.016-1.948l3.376 1.948A4.5 4.5 0 019 9.25c0 .479-.118.958-.316 1.407M16 12a4 4 0 100-8 4 4 0 000 8zM18 16a4 4 0 100-8 4 4 0 000 8z"></path></svg>
                <span>‡πÅ‡∏ä‡∏£‡πå‡∏™‡∏£‡∏∏‡∏õ‡∏ö‡∏¥‡∏• (LINE, ‡∏≠‡∏∑‡πà‡∏ô‡πÜ)</span>
            </button>
            
            <button onclick="document.getElementById('qr-payment-modal').classList.add('hidden')" class="mt-3 w-full bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 rounded-lg">
                ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
            </button>
        </div>
    </div>
    
    <div id="image-upload-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg p-6 shadow-xl w-11/12 max-w-sm">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h3 class="text-xl font-bold text-indigo-600">üñºÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏°‡∏ô‡∏π</h3>
                <button onclick="document.getElementById('image-upload-modal').classList.add('hidden')" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <p class="text-gray-700 mb-4" id="upload-menu-name">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π: **[‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π]**</p>
            <div class="p-4 bg-yellow-50 rounded-lg text-sm mb-4">
                **üí° ‡πÇ‡∏´‡∏°‡∏î‡∏à‡∏≥‡∏Å‡∏±‡∏î (Spark Plan):** ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏° URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• ‡πÅ‡∏ï‡πà‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á (‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ Firebase Storage ‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô Blaze)
            </div>
            
            <label for="menu-image-url" class="block text-sm font-medium text-gray-700 mb-1">URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡πá‡∏ö‡∏≠‡∏∑‡πà‡∏ô):</label>
            <input type="text" id="menu-image-url" placeholder="Paste image URL here" class="w-full mb-4 p-2 border border-gray-300 rounded-lg focus:ring-indigo-500">
            
            <button onclick="saveImageUrlToMenu()" id="save-url-btn" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 rounded-lg transition duration-300">
                üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
            </button>
        </div>
    </div>
    
    <div id="owner-login-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg p-6 shadow-xl w-11/12 max-w-sm">
            <h3 class="text-xl font-bold text-indigo-600 mb-4">üîë ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô)</h3>
            <input type="email" id="owner-email" placeholder="Email" class="w-full mb-3 p-2 border border-gray-300 rounded-lg focus:ring-indigo-500">
            <input type="password" id="owner-password" placeholder="Password" class="w-full mb-4 p-2 border border-gray-300 rounded-lg focus:ring-indigo-500">
            <button onclick="ownerLogin()" class="w-full bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 rounded-lg transition duration-300">
                ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
            </button>
            <button onclick="document.getElementById('owner-login-modal').classList.add('hidden')" class="mt-3 w-full text-sm text-gray-500 hover:text-gray-700">
                ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
            </button>
        </div>
    </div>


    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script> 
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script>
        // 2. ‡πÇ‡∏Ñ‡πâ‡∏î Configuration ‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏Ñ‡∏∏‡∏ì (‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°)
        const firebaseConfig = {
            apiKey: "AIzaSyDztPWzAu8Lz8olg_dhlCLBQVEyjTQqpOk", //
            authDomain: "ordermanagement-f6724.firebaseapp.com", //
            projectId: "ordermanagement-f6724", //
            storageBucket: "ordermanagement-f6724.appspot.com", //
            messagingSenderId: "321286666597",
            appId: "1:321286666597:web:062fef7df8fc456fec098c",
        };

        // 3. Initialize App ‡πÅ‡∏•‡∏∞ Firestore
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth(); // NEW: Auth service
        // const storage = firebase.storage(); // NEW: Storage service (‡∏ñ‡∏π‡∏Å‡∏ñ‡∏≠‡∏î‡∏≠‡∏≠‡∏Å)
        
        // ====================================================================
        // üìù START: ‡πÇ‡∏Ñ‡πâ‡∏î JavaScript ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô Firebase) üìù
        // ====================================================================

        // *** Menu Data (Full lists) *** (‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
        const menuData = [
            { id: 1, name: '‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
            { id: 2, name: '‡πÅ‡∏Ñ‡∏ô‡∏ï‡∏≤‡∏•‡∏π‡∏õ', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
            { id: 3, name: '‡∏ô‡∏°‡∏™‡∏î', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
            { id: 4, name: '‡∏ô‡∏°‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
            { id: 5, name: '‡∏ô‡∏°‡∏ß‡∏≤‡∏ô‡∏¥‡∏•‡∏•‡∏≤', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
            { id: 6, name: '‡∏ô‡∏°‡∏Ñ‡∏≤‡∏£‡∏≤‡πÄ‡∏°‡∏•', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
            { id: 7, name: '‡∏ô‡∏°‡πÄ‡∏¢‡πá‡∏ô/‡∏ô‡∏°‡∏ä‡∏°‡∏û‡∏π', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
            { id: 8, name: '‡∏ô‡∏°‡∏ö‡∏£‡∏≤‡∏ß‡∏ô‡πå‡∏ä‡∏π‡∏Å‡∏≤‡∏£‡πå', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
            { id: 9, name: '‡∏ô‡∏°‡∏™‡∏î ‡∏á‡∏≤‡∏î‡∏≥', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
            { id: 10, name: '‡∏ô‡∏°‡∏°‡∏¥‡πâ‡∏ô‡∏ó‡πå', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
            { id: 11, name: '‡πÇ‡∏Å‡πÇ‡∏Å‡πâ', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
            { id: 12, name: '‡∏ô‡∏°‡∏°‡∏¥‡πâ‡∏ô‡∏ó‡πå‡πÇ‡∏Å‡πÇ‡∏Å‡πâ', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
            { id: 13, name: '‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï', prices: { '16 Oz.': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: 14, name: '‡∏ô‡∏°‡∏°‡∏¥‡πâ‡∏ô‡∏ó‡πå‡∏ä‡πá‡∏≠‡∏Å', prices: { '16 Oz.': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: 15, name: '‡∏ô‡∏°‡∏™‡∏î‡πÇ‡∏≠‡∏£‡∏¥‡πÇ‡∏≠‡πâ', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
            { id: 16, name: '‡∏ô‡∏°‡∏Å‡∏•‡πâ‡∏ß‡∏¢', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
            { id: 17, name: '‡∏Å‡∏•‡πâ‡∏ß‡∏¢‡∏ä‡πá‡∏≠‡∏Å', prices: { '16 Oz.': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: 18, name: '‡∏Å‡∏•‡πâ‡∏ß‡∏¢‡πÇ‡∏Å‡πÇ‡∏Å‡πâ', prices: { '16 Oz.': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: 19, name: '‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏ô‡∏°‡∏™‡∏î', prices: { '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 55 } },
            { id: 20, name: '‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢ (‡πÑ‡∏ï‡πâ‡∏´‡∏ß‡∏±‡∏ô)', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
            { id: 21, name: '‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢ (‡πÉ‡∏ö‡∏ä‡∏≤)', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
            { id: 22, name: '‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢ ‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß', prices: { '16 Oz.': 45, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
            { id: 23, name: '‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (‡πÑ‡∏°‡πà‡∏Å‡∏•‡∏¥‡πà‡∏ô‡∏°‡∏∞‡∏•‡∏¥)', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
            { id: 24, name: '‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß', prices: { '16 Oz.': 45, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
            { id: 25, name: '‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏°‡∏∞‡∏ô‡∏≤‡∏ß', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
            { id: 26, name: '‡∏ä‡∏≤‡∏°‡∏∞‡∏ô‡∏≤‡∏ß', prices: { '16 Oz.': 30, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45 } },
            { id: 27, name: '‡∏ä‡∏≤‡∏û‡∏µ‡∏ä', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
            { id: 28, name: '‡∏ä‡∏≤‡∏°‡∏∞‡∏•‡∏¥', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
            { id: 29, name: '‡∏ä‡∏≤‡∏•‡∏¥‡πâ‡∏ô‡∏à‡∏µ‡πà', prices: { '16 Oz.': 35, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50 } },
        ];
        
        const matchaMenuData = [
            { id: -1, name: '‡πÄ‡∏û‡∏µ‡∏¢‡∏ß‡∏°‡∏±‡∏ó‡∏â‡∏∞', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40 } },
            { id: -2, name: '‡πÄ‡∏û‡∏µ‡∏¢‡∏ß‡∏°‡∏±‡∏ó‡∏â‡∏∞ ‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40 } },
            { id: -3, name: '‡πÄ‡∏û‡∏µ‡∏¢‡∏ß‡∏°‡∏±‡∏ó‡∏â‡∏∞ ‡∏ß‡∏≤‡∏ô‡∏¥‡∏•‡∏•‡∏≤', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40 } },
            { id: -4, name: '‡πÄ‡∏û‡∏µ‡∏¢‡∏ß‡∏°‡∏±‡∏ó‡∏â‡∏∞ ‡∏Ñ‡∏≤‡∏£‡∏≤‡πÄ‡∏°‡∏•', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40 } },
            { id: -5, name: '‡πÄ‡∏û‡∏µ‡∏¢‡∏ß‡∏°‡∏±‡∏ó‡∏â‡∏∞ ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60 } },
            { id: -6, name: '‡πÄ‡∏û‡∏µ‡∏¢‡∏ß‡∏°‡∏±‡∏ó‡∏â‡∏∞ ‡∏ô‡πâ‡∏≥‡∏™‡πâ‡∏°', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60 } },
            { id: -7, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
            { id: -8, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡πÇ‡∏≠‡∏£‡∏¥‡πÇ‡∏≠‡πâ', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
            { id: -9, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏Ñ‡∏≤‡∏£‡∏≤‡πÄ‡∏°‡∏•', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -10, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏™‡∏î', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
            { id: -11, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏ß‡∏≤‡∏ô‡∏¥‡∏•‡∏•‡∏≤', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -12, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
            { id: -13, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏ö‡∏•‡∏π‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
            { id: -14, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -15, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞ ‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤‡πÇ‡∏ô‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 70 } },
            { id: -16, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏Ñ‡∏≠‡∏ü‡∏ü‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 70 } },
            { id: -17, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏ñ‡∏±‡πà‡∏ß‡πÅ‡∏î‡∏á', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
            { id: -18, name: '‡∏°‡∏±‡∏ó‡∏â‡∏∞ ‡∏ñ‡∏±‡πà‡∏ß‡πÅ‡∏î‡∏á (‡∏õ‡∏±‡πà‡∏ô)', prices: { '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
        ];
        
        const coffeeMenuData = [
            { id: -101, name: '‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤‡πÇ‡∏ô‡πà', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 45, '‡∏õ‡∏±‡πà‡∏ô': 55 } },
            { id: -102, name: '‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤‡πÇ‡∏ô‡πà ‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 50, '‡∏õ‡∏±‡πà‡∏ô': 60 } },
            { id: -103, name: '‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤‡πÇ‡∏ô‡πà ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -104, name: '‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤‡πÇ‡∏ô‡πà ‡∏ô‡πâ‡∏≥‡∏™‡πâ‡∏°', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -105, name: '‡πÄ‡∏≠‡∏™‡πÄ‡∏õ‡∏£‡∏™‡πÇ‡∏ã‡πà', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -106, name: '‡∏•‡∏≤‡πÄ‡∏ï‡πâ', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -107, name: '‡∏•‡∏≤‡πÄ‡∏ï‡πâ ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß ‡∏ô‡∏°‡∏™‡∏î', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -108, name: '‡∏ß‡∏≤‡∏ô‡∏¥‡∏•‡∏•‡∏≤ ‡∏•‡∏≤‡πÄ‡∏ï‡πâ', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -109, name: '‡∏Ñ‡∏≤‡∏õ‡∏π‡∏ä‡∏¥‡πÇ‡∏ô‡πà', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -110, name: '‡∏°‡∏≠‡∏Ñ‡∏Ñ‡πà‡∏≤', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -111, name: '‡∏Ñ‡∏≤‡∏£‡∏≤‡πÄ‡∏°‡∏• ‡∏°‡∏±‡∏Ñ‡∏Ñ‡∏¥‡∏≠‡∏≤‡πÇ‡∏ï‡πâ', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -112, name: '‡πÄ‡∏Æ‡πÄ‡∏ã‡∏•‡∏ô‡∏±‡∏ó ‡∏•‡∏≤‡πÄ‡∏ï‡πâ', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -113, name: '‡∏°‡∏≠‡∏Ñ‡∏Ñ‡πà‡∏≤ ‡∏°‡∏¥‡πâ‡∏ô‡∏ó‡πå', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -114, name: '‡πÑ‡∏ß‡∏ó‡πå‡∏ä‡πá‡∏≠‡∏Å ‡∏°‡∏≠‡∏Ñ‡∏Ñ‡πà‡∏≤', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -115, name: '‡∏Ñ‡∏≤‡∏£‡∏≤‡πÄ‡∏°‡∏• ‡πÄ‡∏Æ‡πÄ‡∏ã‡∏•‡∏ô‡∏±‡∏ó ‡∏•‡∏≤‡πÄ‡∏ï‡πâ', prices: { '‡πÄ‡∏¢‡πá‡∏ô': 55, '‡∏õ‡∏±‡πà‡∏ô': 65 } },
        ];
        
        const fruitSmoothieData = [
            { id: -201, name: '‡∏ô‡∏°‡∏™‡∏î ‡∏Å‡∏µ‡∏ß‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 55 } },
            { id: -202, name: '‡∏ô‡∏°‡∏™‡∏î ‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 40, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 45, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 55 } },
            { id: -203, name: '‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà ‡∏ä‡πá‡∏≠‡∏Å', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
            { id: -204, name: '‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢ ‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
            { id: -205, name: '‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
            { id: -206, name: '‡πÇ‡∏Å‡πÇ‡∏Å‡πâ ‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
            { id: -207, name: '‡∏ä‡πá‡∏≠‡∏Å ‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 50, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 55, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 60, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -208, name: '‡∏ô‡∏°‡∏™‡∏î ‡∏ö‡∏•‡∏π‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 45, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
            { id: -209, name: '‡∏ö‡∏•‡∏π‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà ‡∏ä‡πá‡∏≠‡∏Å', prices: { '16 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 55, '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60, '22 Oz. ‡πÄ‡∏¢‡πá‡∏ô': 65, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 70 } },
        ];

        const smoothieYogurtData = [
            { id: -301, name: '‡∏Å‡∏µ‡∏ß‡∏µ‡πà', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
            { id: -302, name: '‡∏™‡∏ï‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
            { id: -303, name: '‡∏û‡∏µ‡∏ä', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
            { id: -304, name: '‡∏ö‡∏•‡∏π‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -305, name: '‡∏°‡∏¥‡∏Å‡∏ã‡πå‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -306, name: '‡πÇ‡∏¢‡πÄ‡∏Å‡∏¥‡∏£‡πå‡∏ï ‡∏õ‡∏µ‡πÇ‡∏õ‡πâ', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
            { id: -307, name: '‡∏•‡∏¥‡πâ‡∏ô‡∏à‡∏µ‡πà', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 55, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 65 } },
            { id: -308, name: '‡∏™‡πâ‡∏°', prices: { '16 Oz. ‡∏õ‡∏±‡πà‡∏ô': 50, '22 Oz. ‡∏õ‡∏±‡πà‡∏ô': 60 } },
        ];

        // ‡∏£‡∏ß‡∏°‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        const allMenuData = [...menuData, ...matchaMenuData, ...coffeeMenuData, ...fruitSmoothieData, ...smoothieYogurtData];
        const sweetnessOptions = ['100%', '75%', '50%', '25%'];

        // üî• Firebase Global Variables üî•
        let currentOrder = [];
        let orderQueue = []; 
        let menuSalesLog = []; 
        let currentMenuDoc = null; // NEW: To store the currently selected menu item for image upload

        const menuGrid = document.getElementById('menu-grid');
        const currentOrderItemsEl = document.getElementById('current-order-items');
        const totalPriceEl = document.getElementById('total-price');
        const submitOrderBtn = document.getElementById('submit-order-btn');
        const orderQueueEl = document.getElementById('order-queue');
        const deliveryAddressInput = document.getElementById('delivery-address');

        const salesTodayEl = document.getElementById('sales-today');
        const salesWeekEl = document.getElementById('sales-week');
        const salesMonthEl = document.getElementById('sales-month');
        const menuReportModal = document.getElementById('menu-report-modal');
        const menuReportContent = document.getElementById('menu-report-content');
        const qrPaymentModal = document.getElementById('qr-payment-modal');
        const qrTotalAmountEl = document.getElementById('qr-total-amount');

        let lastCommittedOrder = null;
        let isOwnerLoggedIn = false; // NEW: Flag for owner status

        // Helper function to find item data from all menus (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°)
        function getItemDataById(itemId) {
            return allMenuData.find(i => i.id === itemId);
        }
        
        function showPaymentQRModal(orderTotal) {
            qrTotalAmountEl.textContent = `‡∏ø${orderTotal.toLocaleString('th-TH')}`;
            qrPaymentModal.classList.remove('hidden');
        }

        // --- Date Helper Functions (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°) ---
        function isToday(date) {
            const today = new Date();
            return date.getDate() === today.getDate() && date.getMonth() === today.getMonth() && date.getFullYear() === today.getFullYear();
        }

        function isThisWeek(date) {
            const now = new Date();
            const startOfWeek = new Date(now.setDate(now.getDate() - now.getDay()));
            const endOfWeek = new Date(now.setDate(now.getDate() - now.getDay() + 6));
            return date >= startOfWeek && date <= endOfWeek;
        }

        function isThisMonth(date) {
            const now = new Date();
            return date.getMonth() === now.getMonth() && date.getFullYear() === now.getFullYear();
        }

        // üî• Firebase Realtime Listeners (‡πÉ‡∏ä‡πâ Query 2 ‡∏ä‡∏±‡πâ‡∏ô) üî•
        function initFirebaseListeners() {
            // ‡πÉ‡∏ä‡πâ "orders" (‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å)
            db.collection("orders") 
                .orderBy("status", "asc") 
                .orderBy("placedAt", "asc") 
                .onSnapshot(snapshot => { 
                    orderQueue = snapshot.docs.map(doc => ({ 
                        id: doc.id, 
                        ...doc.data() 
                    }));
                    
                    renderOrderQueue();
                }, error => {
                    console.error("Firebase Order Listener Error:", error);
                    orderQueueEl.innerHTML = '<p class="text-red-500 text-center mt-4 font-bold">‚ö†Ô∏è ERROR: ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ (‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console/Rules/Index)</p>';
                });

            // 2. Listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (salesLog Collection)
            db.collection("salesLog").onSnapshot(snapshot => {
                menuSalesLog = snapshot.docs.map(doc => doc.data());
                updateSalesDashboard();
            }, error => {
                console.error("Firebase Sales Listener Error:", error);
            });
            
            // NEW: Auth listener for owner status
            auth.onAuthStateChanged(handleAuthChange);
        }
        
        // --- Core Application Logic (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å) ---
        
        // Function to create a simple menu button
        function createMenuItemButton(item, size, price, colorClass) {
            // *** UPDATED LOGIC HERE (Size Label) ***
            let sizeLabel = size;
            
            if (size.includes('Oz.')) {
                // 1. Clean up "Oz." to "‡∏≠‡∏≠‡∏ô‡∏ã‡πå"
                sizeLabel = size.replace('Oz.', '‡∏≠‡∏≠‡∏ô‡∏ã‡πå').replace('16', '16').replace('22', '22');
                
                // 2. Custom rule: Add "‡πÄ‡∏¢‡πá‡∏ô" to "16 Oz." if it is ONLY "16 Oz." (e.g., in standard menu and no '‡∏õ‡∏±‡πà‡∏ô' version for 16oz exists)
                if (size === '16 Oz.' && item.prices['16 Oz. ‡∏õ‡∏±‡πà‡∏ô']) {
                    sizeLabel = '16 ‡∏≠‡∏≠‡∏ô‡∏ã‡πå ‡πÄ‡∏¢‡πá‡∏ô';
                } else if (size === '16 Oz.' && item.prices['22 Oz. ‡πÄ‡∏¢‡πá‡∏ô'] && !item.prices['16 Oz. ‡∏õ‡∏±‡πà‡∏ô']) {
                    sizeLabel = '16 ‡∏≠‡∏≠‡∏ô‡∏ã‡πå ‡πÄ‡∏¢‡πá‡∏ô';
                }
                
                // 3. Keep "‡∏õ‡∏±‡πà‡∏ô" explicit
                sizeLabel = sizeLabel.replace('‡∏õ‡∏±‡πà‡∏ô', '‡∏õ‡∏±‡πà‡∏ô');
            }
            // For Coffee size like '‡πÄ‡∏¢‡πá‡∏ô' or '‡∏õ‡∏±‡πà‡∏ô', use the exact name
            else if (size === '‡πÄ‡∏¢‡πá‡∏ô' || size === '‡∏õ‡∏±‡πà‡∏ô') {
                sizeLabel = size;
            }
            // ****************************

            const menuItem = document.createElement('div');
            menuItem.className = `main-menu-card ${colorClass}`;
            // NEW FUNCTION CALL: Pass itemId, size, and price directly
            menuItem.setAttribute('onclick', `addToOrder(${item.id}, '${size.replace(/'/g, "\\'")}', ${price})`);

            let imageHtml = '';
            if (item.imageUrl) {
                 imageHtml = `<img src="${item.imageUrl}" alt="${item.name} image" class="menu-image">`;
            } else {
                 imageHtml = `<div class="menu-image flex items-center justify-center text-xs text-gray-400 bg-gray-100">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</div>`;
            }
            
            // NEW: Upload Button (Hidden by default, shown by JS when owner logs in)
            // Note: We pass the menu ID for future use when enabling Storage
            const uploadBtnHtml = `<span class="upload-img-btn text-xs" style="display: none;" onclick="event.stopPropagation(); showImageUploadModal(${item.id}, '${item.name}', '${size.replace(/'/g, "\\'")}', ${price})">üì∑</span>`;

            // *** ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏•‡∏ö‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π (item.name) ***
            menuItem.innerHTML = `
                ${uploadBtnHtml}
                ${imageHtml}
                <p class="menu-name">${item.name}</p>
                <p class="text-gray-500 text-xs">${sizeLabel}</p>
                <p class="menu-price-tag text-teal-600">‡∏ø${price.toLocaleString('th-TH')}</p>
            `;
            return menuItem;
        }

        // NEW: Function to render specific category menus
        function renderCategoryMenu(categoryName, menuData, colorClass, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            // Logic to determine which sizes/options to show as separate buttons for this category
            menuData.forEach(item => {
                const availableSizes = Object.keys(item.prices);
                
                availableSizes.forEach(size => {
                    const price = item.prices[size];
                    const button = createMenuItemButton(item, size, price, colorClass);
                    container.appendChild(button);
                });
            });
            
            // Ensure owner upload buttons are visible if logged in
            if (isOwnerLoggedIn) {
                document.querySelectorAll('.upload-img-btn').forEach(btn => btn.style.display = 'block');
            }
        }


        // Function to handle the category toggle
        function toggleCategory(containerId) {
            const container = document.getElementById(containerId);
            container.classList.toggle('hidden');
            
            // Optional: rotate arrow icon (for visual feedback)
            const btn = document.querySelector(`#${containerId}`).previousElementSibling;
            const arrow = btn.querySelector('svg');
            arrow.classList.toggle('rotate-180');
        }

        function renderMenu() {
            menuGrid.innerHTML = ''; // Clear existing grid
            
            // Define Categories
            const categories = [
                { title: 'ü•õ ‡∏ô‡∏°/‡∏ä‡∏≤/‡πÇ‡∏Å‡πÇ‡∏Å‡πâ (Standard)', data: menuData, color: 'bg-teal-500 hover:bg-teal-600', colorClass: 'bg-teal-50 hover:bg-teal-100', containerId: 'menu-standard' },
                { title: 'üçµ ‡πÄ‡∏°‡∏ô‡∏π‡∏°‡∏±‡∏ó‡∏â‡∏∞/‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß', data: matchaMenuData, color: 'bg-emerald-500 hover:bg-emerald-600', colorClass: 'bg-emerald-50 hover:bg-emerald-100', containerId: 'menu-matcha' },
                { title: '‚òï ‡πÄ‡∏°‡∏ô‡∏π‡∏Å‡∏≤‡πÅ‡∏ü (COFFEE)', data: coffeeMenuData, color: 'bg-amber-700 hover:bg-amber-800', colorClass: 'bg-amber-50 hover:bg-amber-100', containerId: 'menu-coffee' },
                { title: 'üçì ‡∏™‡∏°‡∏π‡∏ó‡∏ï‡∏µ‡πâ‡∏ú‡∏•‡πÑ‡∏°‡πâ (Fruit)', data: fruitSmoothieData, color: 'bg-sky-500 hover:bg-sky-600', colorClass: 'bg-sky-50 hover:bg-sky-100', containerId: 'menu-fruit' },
                { title: 'üçá ‡∏™‡∏°‡∏π‡∏ó‡∏ï‡∏µ‡πâ‡πÇ‡∏¢‡πÄ‡∏Å‡∏¥‡∏£‡πå‡∏ï (Yogurt)', data: smoothieYogurtData, color: 'bg-indigo-500 hover:bg-indigo-600', colorClass: 'bg-indigo-50 hover:bg-indigo-100', containerId: 'menu-yogurt' },
            ];

            categories.forEach(category => {
                // 1. Create the Toggle Button
                const toggleBtn = document.createElement('div');
                toggleBtn.className = `category-toggle-btn ${category.color}`;
                toggleBtn.setAttribute('onclick', `toggleCategory('${category.containerId}')`);
                toggleBtn.innerHTML = `
                    <span>${category.title}</span>
                    <svg class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                `;
                menuGrid.appendChild(toggleBtn);

                // 2. Create the Menu Container (hidden by default)
                const menuContainer = document.createElement('div');
                menuContainer.id = category.containerId;
                menuContainer.className = 'menu-container-grid hidden'; // Starts hidden
                menuGrid.appendChild(menuContainer);

                // 3. Populate the container with individual menu items (buttons)
                renderCategoryMenu(category.title, category.data, category.colorClass, category.containerId);
            });
        }
        
        function addToOrder(itemId, size = null, price = null) {
            const item = getItemDataById(itemId);
            if (!item) return;

            // 1. Determine size and price based on passed arguments or default
            let finalSize = size;
            let finalPrice = price;

            if (finalSize === null || finalPrice === null) {
                // Fallback to the first available size if size/price are not passed
                const defaultSize = Object.keys(item.prices)[0];
                finalSize = defaultSize;
                finalPrice = item.prices[defaultSize];
            }

            const defaultSweetness = sweetnessOptions[0];

            // 2. Create the new order item object
            const orderItem = {
                id: Date.now(),
                itemId: item.id,
                name: item.name,
                size: finalSize, 
                price: finalPrice, 
                quantity: 1,
                sweetness: defaultSweetness,
            };
            
            // 3. Check if item already exists in current order (for stacking)
            const existingItemIndex = currentOrder.findIndex(
                i => i.itemId === itemId && i.size === finalSize && i.sweetness === defaultSweetness
            );

            if (existingItemIndex !== -1) {
                // If found, just increase quantity
                currentOrder[existingItemIndex].quantity += 1;
            } else {
                // If not found, add new item
                currentOrder.push(orderItem);
            }
            
            // 4. Re-render the cart
            renderCurrentOrder();
        }
        
        // --- Owner Authentication & Image URL Saving Logic (No Storage Used) ---
        
        function showOwnerLogin() {
            document.getElementById('owner-login-modal').classList.remove('hidden');
        }
        
        function ownerLogin() {
            const email = document.getElementById('owner-email').value;
            const password = document.getElementById('owner-password').value;
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    alert("‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
                    document.getElementById('owner-login-modal').classList.add('hidden');
                })
                .catch((error) => {
                    alert(`‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${error.message}`);
                });
        }
        
        function handleAuthChange(user) {
            if (user) {
                // Owner is logged in
                isOwnerLoggedIn = true;
                document.getElementById('owner-login-btn').classList.add('hidden');
                document.getElementById('owner-logout-btn').classList.remove('hidden');
                document.querySelectorAll('.upload-img-btn').forEach(btn => btn.style.display = 'block');
                
                // Optional: Show status
                alert(`‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ: ${user.email} ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß (‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô)`);
            } else {
                // Owner is logged out
                isOwnerLoggedIn = false;
                document.getElementById('owner-login-btn').classList.remove('hidden');
                document.getElementById('owner-logout-btn').classList.add('hidden');
                document.querySelectorAll('.upload-img-btn').forEach(btn => btn.style.display = 'none');
            }
        }
        
        function showImageUploadModal(itemId, itemName) {
            currentMenuDoc = itemId; 
            const item = getItemDataById(itemId);
            
            document.getElementById('upload-menu-name').textContent = `‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π: **${itemName}** (ID: ${itemId})`;
            document.getElementById('menu-image-url').value = item.imageUrl || ''; // Pre-fill current URL if exists
            document.getElementById('image-upload-modal').classList.remove('hidden');
        }

        // NEW: Function to save image URL directly to the local menu data (NO FIREBASE STORAGE)
        function saveImageUrlToMenu() {
            if (!currentMenuDoc) return alert("Error: ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å");
            
            const imageUrl = document.getElementById('menu-image-url').value.trim();
            
            // Find the corresponding item in the menu data array
            const itemIndex = allMenuData.findIndex(item => item.id === currentMenuDoc);
            if (itemIndex === -1) {
                alert("Error: ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");
                return;
            }
            
            // Update the local data with the imageUrl
            allMenuData[itemIndex].imageUrl = imageUrl;
            
            // Re-render the menu to show the image
            renderMenu(); 
            
            alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤ ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Firestore)");
            document.getElementById('image-upload-modal').classList.add('hidden');
        }
        
        // --- The rest of the functions (renderCurrentOrder, updateOrderStatus, etc.) are standard ---

        function renderCurrentOrder() {
            if (currentOrder.length === 0) {
                currentOrderItemsEl.innerHTML = '<p class="text-gray-400 text-center mt-4">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°...</p>';
                submitOrderBtn.disabled = true;
            } else {
                currentOrderItemsEl.innerHTML = '';
                currentOrder.forEach(item => {
                    const menuItem = getItemDataById(item.itemId);
                    const availableSizes = Object.keys(menuItem.prices);

                    const sizeOptions = availableSizes.map(size => `<option value="${size}" ${item.size === size ? 'selected' : ''}>${size}</option>`).join('');
                    const sweetnessDropdown = sweetnessOptions.map(level => `<option value="${level}" ${item.sweetness === level ? 'selected' : ''}>${level}</option>`).join('');

                    const itemEl = document.createElement('div');
                    itemEl.className = 'flex items-center justify-between bg-gray-50 p-2 rounded-lg';
                    itemEl.innerHTML = `
                        <div class="flex-grow grid grid-cols-2 gap-2">
                            <p class="font-semibold col-span-2">${item.name}</p>
                            <div class="flex flex-col">
                                <span class="text-xs font-medium text-gray-500 mb-1">‡∏Ç‡∏ô‡∏≤‡∏î</span>
                                <select class="text-sm p-1 border rounded" onchange="updateOrderItemSize(${item.id}, this.value)">${sizeOptions}</select>
                            </div>
                            <div class="flex flex-col">
                                <span class="text-xs font-medium text-gray-500 mb-1">‡∏´‡∏ß‡∏≤‡∏ô</span>
                                <select class="text-sm p-1 border rounded" onchange="updateOrderItemSweetness(${item.id}, this.value)">${sweetnessDropdown}</select>
                            </div>
                        </div>
                        <div class="flex items-center gap-2 ml-4">
                            <button class="w-6 h-6 bg-gray-200 rounded-full" onclick="updateOrderItemQuantity(${item.id}, -1)">-</button>
                            <span>${item.quantity}</span>
                            <button class="w-6 h-6 bg-gray-200 rounded-full" onclick="updateOrderItemQuantity(${item.id}, 1)">+</button>
                        </div>
                        <span class="w-20 text-right font-semibold">‡∏ø${(item.price * item.quantity).toLocaleString('th-TH')}</span>
                        <button class="ml-2 text-red-500 hover:text-red-700" onclick="removeOrderItem(${item.id})">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                        </button>
                    `;
                    currentOrderItemsEl.appendChild(itemEl);
                });
                submitOrderBtn.disabled = false;
            }
            updateTotalPrice();
        }

        function updateOrderItemSweetness(orderItemId, newSweetness) {
            const orderItem = currentOrder.find(item => item.id === orderItemId);
            // Check if sweetness is being changed to see if we need to split the order line
            if (orderItem.sweetness !== newSweetness) {
                // If quantity > 1, reduce quantity by 1, and add a new line with new sweetness
                if (orderItem.quantity > 1) {
                    orderItem.quantity -= 1;
                    const newItem = {...orderItem, id: Date.now(), sweetness: newSweetness, quantity: 1};
                    currentOrder.push(newItem);
                } else {
                    // If quantity is 1, just update the sweetness
                    orderItem.sweetness = newSweetness;
                }
            }
            renderCurrentOrder();
        }
        
        function updateOrderItemSize(orderItemId, newSize) {
            const orderItem = currentOrder.find(item => item.id === orderItemId);
            const menuItem = getItemDataById(orderItem.itemId);
            
            if (menuItem.prices[newSize] !== undefined) {
                // Check if size is being changed to see if we need to split the order line
                if (orderItem.size !== newSize) {
                    // If quantity > 1, reduce quantity by 1, and add a new line with new size
                    if (orderItem.quantity > 1) {
                        orderItem.quantity -= 1;
                        const newPrice = menuItem.prices[newSize];
                        const newItem = {...orderItem, id: Date.now(), size: newSize, price: newPrice, quantity: 1};
                        currentOrder.push(newItem);
                    } else {
                        // If quantity is 1, just update size and price
                        orderItem.size = newSize;
                        orderItem.price = menuItem.prices[newSize];
                    }
                }
            }
            renderCurrentOrder();
        }
        
        function updateOrderItemQuantity(orderItemId, change) {
            const orderItem = currentOrder.find(item => item.id === orderItemId);
            if (orderItem.quantity + change > 0) {
                orderItem.quantity += change;
            } else if (orderItem.quantity + change === 0) {
                removeOrderItem(orderItemId); // Remove if quantity hits zero
                return;
            }
            renderCurrentOrder();
        }

        function removeOrderItem(orderItemId) {
            currentOrder = currentOrder.filter(item => item.id !== orderItemId);
            renderCurrentOrder();
        }

        function updateTotalPrice() {
            const total = currentOrder.reduce((sum, item) => sum + item.price * item.quantity, 0);
            totalPriceEl.textContent = `‡∏ø${total.toLocaleString('th-TH')}`;
        }
        
        function shareOrderSummary() {
            if (!lastCommittedOrder) {
                alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ä‡∏£‡πå');
                return;
            }

            const itemsText = lastCommittedOrder.items.map(item =>
                `* ${item.name} (${item.size}, ‡∏´‡∏ß‡∏≤‡∏ô ${item.sweetness}) x${item.quantity} = ‡∏ø${(item.price * item.quantity).toLocaleString('th-TH')}`
            ).join('\n');

            const shareText =
                `‚úÖ *‡∏™‡∏£‡∏∏‡∏õ‡∏ö‡∏¥‡∏• #${lastCommittedOrder.id.substring(0, 8)} - ${new Date().toLocaleDateString('th-TH')}*\n` +
                `----------------------------------------\n` +
                `${itemsText}\n` +
                `----------------------------------------\n` +
                `üìç ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ${lastCommittedOrder.address}\n` +
                `üí∞ *‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô: ‡∏ø${lastCommittedOrder.total.toLocaleString('th-TH')}*\n\n` +
                `üí¨ *[‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô] ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏ä‡πâ QR Code ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏ö‡∏°‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πÅ‡∏Å‡∏ô‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô*\n` +
                `‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ: ‡∏ô.‡∏™.‡∏ô‡∏§‡∏ï‡∏ç‡∏≤ ‡∏ô‡∏≤‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏£‡∏±‡∏Å‡∏©‡πå`;

            if (navigator.share) {
                navigator.share({ title: `‡∏ö‡∏¥‡∏•‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #${lastCommittedOrder.id.substring(0, 8)}`, text: shareText })
                .catch((error) => {
                    navigator.clipboard.writeText(shareText)
                        .then(() => alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏ö‡∏¥‡∏• (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°) ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏•‡πâ‡∏ß!'))
                        .catch(err => console.error('Could not copy text: ', err));
                });
            } else {
                navigator.clipboard.writeText(shareText)
                    .then(() => alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏ö‡∏¥‡∏• (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°) ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏•‡πâ‡∏ß!'))
                    .catch(err => console.error('Could not copy text: ', err));
            }
        }


        // üî• UPDATED: Submit Order (‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏ä‡πâ Firestore) üî•
        submitOrderBtn.addEventListener('click', () => {
            const orderTotal = currentOrder.reduce((sum, item) => sum + item.price * item.quantity, 0);

            if (currentOrder.length > 0) {
                const address = deliveryAddressInput.value.trim();
                const isPickup = address === '';
                
                if (isPickup) {
                     if (!confirm("‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà ‡∏à‡∏∞‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô '‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≤‡∏ô' ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) { return; }
                }

                db.collection("orders").add({ // ‡πÉ‡∏ä‡πâ "orders" ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å
                    items: currentOrder,
                    total: orderTotal,
                    address: address || '‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≤‡∏ô',
                    status: '‡∏Ñ‡∏¥‡∏ß',
                    placedAt: firebase.firestore.FieldValue.serverTimestamp(), // ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏≤‡∏Å Server
                })
                .then(docRef => {
                    lastCommittedOrder = {
                         id: docRef.id, 
                         items: [...currentOrder],
                         total: orderTotal,
                         address: address || '‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≤‡∏ô',
                    };
                    
                    currentOrder = []; 
                    deliveryAddressInput.value = '';
                    renderCurrentOrder(); 
                    showPaymentQRModal(orderTotal);
                })
                .catch(error => {
                    console.error("Error adding document: ", error);
                    alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà");
                });
            }
        });

        // üî• UPDATED: renderOrderQueue (‡πÉ‡∏ä‡πâ Order ID ‡∏à‡∏≤‡∏Å Firestore ‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞) üî•
        function renderOrderQueue() {
            const displayQueue = orderQueue.filter(order => order.status !== '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß' && order.status !== '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å');

            if (displayQueue.length === 0) {
                orderQueueEl.innerHTML = '<p class="text-gray-400 text-center mt-4">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏ô‡∏Ñ‡∏¥‡∏ß</p>';
                return;
            }
            
            orderQueueEl.innerHTML = '';
            displayQueue.forEach(order => {
                const itemsSummary = order.items.map(item => `${item.name} (${item.size}, ‡∏´‡∏ß‡∏≤‡∏ô ${item.sweetness}) x${item.quantity}`).join(', ');
                const statusColor = {
                    '‡∏Ñ‡∏¥‡∏ß': 'bg-blue-100 text-blue-800',
                    '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥': 'bg-yellow-100 text-yellow-800',
                    '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß': 'bg-green-100 text-green-800',
                    '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å': 'bg-red-100 text-red-800'
                }[order.status];
                
                const isCompleted = order.status === '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß' || order.status === '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å';

                const orderCard = document.createElement('div');
                orderCard.className = `p-4 rounded-lg shadow-sm ${isCompleted ? 'bg-gray-200 opacity-75' : 'bg-gray-50 hover:bg-white'}`;
                
                orderCard.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <h4 class="font-bold text-lg">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #${order.id.substring(0, 8)}...</h4> 
                            <p class="text-sm text-gray-600">${itemsSummary}</p>
                            <p class="text-xs text-gray-500 mt-1">
                                <span class="font-semibold">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</span> ${order.address}
                            </p>
                        </div>
                        <span class="text-lg font-bold text-teal-600">‡∏ø${order.total.toLocaleString('th-TH')}</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-semibold px-2.5 py-0.5 rounded-full ${statusColor}">${order.status}</span>
                        <div class="flex gap-2">
                            ${order.status === '‡∏Ñ‡∏¥‡∏ß' ? `<button class="text-xs bg-yellow-400 hover:bg-yellow-500 text-white font-bold py-1 px-3 rounded-lg" onclick="updateOrderStatus('${order.id}', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥')">‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</button>` : ''}
                            ${order.status === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥' ? `<button class="text-xs bg-green-500 hover:bg-green-600 text-white font-bold py-1 px-3 rounded-lg" onclick="updateOrderStatus('${order.id}', '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß')">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</button>` : ''}
                            ${!isCompleted ? `<button class="text-xs bg-red-500 hover:bg-red-600 text-white font-bold py-1 px-3 rounded-lg" onclick="updateOrderStatus('${order.id}', '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>` : ''}
                        </div>
                    </div>
                `;
                orderQueueEl.appendChild(orderCard);
            });
        }

        // üî• UPDATED: updateOrderStatus (‡πÉ‡∏ä‡πâ Firebase ID/Doc Ref) üî•
        function updateOrderStatus(orderId, newStatus) {
            const order = orderQueue.find(o => o.id === orderId);
            if (!order) return;

            const updateData = { status: newStatus };
            if (newStatus === '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß') {
                updateData.completedAt = firebase.firestore.FieldValue.serverTimestamp();
                
                const batch = db.batch(); 
                order.items.forEach(item => {
                    const newLogRef = db.collection("salesLog").doc();
                    batch.set(newLogRef, {
                        name: item.name,
                        size: item.size,
                        sweetness: item.sweetness,
                        quantity: item.quantity,
                        price: item.price,
                        soldAt: updateData.completedAt,
                        orderId: orderId
                    });
                });
                batch.commit().then(() => {
                    console.log("Sales Log batch successfully written!");
                }).catch((error) => {
                    console.error("Error writing sales log batch: ", error);
                });
            }
            
            db.collection("orders").doc(orderId).update(updateData)
                .then(() => console.log("Order status updated!"))
                .catch(error => console.error("Error updating order: ", error));
        }

        function updateSalesDashboard() {
            let salesToday = 0;
            let salesWeek = 0;
            let salesMonth = 0;
            
            menuSalesLog.forEach(log => {
                const saleDate = log.soldAt ? new Date(log.soldAt.seconds * 1000) : new Date();
                
                const totalRevenue = log.price * log.quantity;

                if (isToday(saleDate)) { salesToday += totalRevenue; }
                if (isThisWeek(saleDate)) { salesWeek += totalRevenue; }
                if (isThisMonth(saleDate)) { salesMonth += totalRevenue; }
            });
            
            salesTodayEl.textContent = `‡∏ø${salesToday.toLocaleString('th-TH')}`;
            salesWeekEl.textContent = `‡∏ø${salesWeek.toLocaleString('th-TH')}`;
            salesMonthEl.textContent = `‡∏ø${salesMonth.toLocaleString('th-TH')}`;
        }

        function showMenuReport() {
            const menuSales = {};
            
            menuSalesLog.forEach(log => {
                const key = `${log.name} (${log.size}, ‡∏´‡∏ß‡∏≤‡∏ô ${log.sweetness})`;
                if (!menuSales[key]) {
                    menuSales[key] = { name: log.name, size: log.size, sweetness: log.sweetness, totalQuantity: 0, totalRevenue: 0, };
                }
                menuSales[key].totalQuantity += log.quantity;
                menuSales[key].totalRevenue += log.price * log.quantity;
            });
            
            const sortedMenuReport = Object.values(menuSales).sort((a, b) => b.totalQuantity - a.totalQuantity);
            let tableHTML = '<p class="text-gray-500 mb-4">‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏Å‡πâ‡∏ß‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</p>';
            if (sortedMenuReport.length === 0) {
                tableHTML += '<p class="text-center text-gray-400 mt-10">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</p>';
            } else {
                tableHTML += `<table class="min-w-full divide-y divide-gray-200"><thead class="bg-teal-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡πÄ‡∏°‡∏ô‡∏π / ‡∏Ç‡∏ô‡∏≤‡∏î / ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏≤‡∏ô</th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡πÅ‡∏Å‡πâ‡∏ß)</th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏° (‡∏ø)</th></tr></thead><tbody class="bg-white divide-y divide-gray-200">`;
                sortedMenuReport.forEach( (report, index) => {
                    tableHTML += `<tr class="${index < 3 ? 'bg-yellow-50 font-semibold' : ''}"><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${report.name} (${report.size}, ‡∏´‡∏ß‡∏≤‡∏ô ${report.sweetness})</td><td class="px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900">${report.totalQuantity.toLocaleString('th-TH')}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-right text-teal-600">${report.totalRevenue.toLocaleString('th-TH')}</td></tr>`;
                });
                tableHTML += '</tbody></table>';
            }
            menuReportContent.innerHTML = tableHTML;
            menuReportModal.classList.remove('hidden');
        }

        // --- Initial setup ---
        renderMenu();
        renderCurrentOrder();
        initFirebaseListeners(); // ** ‡πÄ‡∏£‡∏¥‡πà‡∏° Listener ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà **
    </script>
</body>
</html>
